(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{28:function(e,t,a){e.exports=a(52)},39:function(e,t,a){},40:function(e,t,a){},50:function(e,t,a){},52:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"createGame",function(){return b}),a.d(n,"wipe",function(){return E}),a.d(n,"load",function(){return k}),a.d(n,"getCurrPlayerState",function(){return O}),a.d(n,"play",function(){return C}),a.d(n,"discard",function(){return j}),a.d(n,"advise",function(){return S});var r=a(1),i=a.n(r),s=a(10),l=a.n(s),o=(a(39),a(40),a(26)),c=a(5),u=a(6),d=a(8),m=a(7),h=a(9),p=a(3),v=a(27),y=a(13),f=a(4),g=a.n(f);function b(e){var t=g.a.createGame({playerNames:e});return localStorage.setItem("game"+t.id,JSON.stringify(g.a.getGame())),t}function E(){localStorage.removeItem("game"+g.a.getGame().id)}function k(e,t){var a=localStorage.getItem("game"+e),n=JSON.parse(a),r=g.a.loadGame(n);console.log("game",g.a.getGame()),t(r)}function w(){var e=g.a.getGame();localStorage.setItem("game"+e.id,JSON.stringify(e))}function O(e){var t=g.a.getGame(),a=t.players[t.whosTurn].id;e(g.a.getPlayerGameState(a))}function C(e,t){var a=g.a.getGame(),n=a.players[a.whosTurn].id,r=g.a.play(n,e);console.log("play res",r),w(),t(r)}function j(e,t){var a=g.a.getGame(),n=a.players[a.whosTurn].id,r=g.a.discard(n,e);console.log("discard res",r),w(),t(r)}function S(e,t,a){var n=g.a.getGame(),r=n.players[n.whosTurn].id,i=n.players.findIndex(function(t){return t.hand.findIndex(function(t){return t.id===e})>=0}),s=g.a.advise(r,i,t);console.log("advise res",s),console.log("game",g.a.getGame()),w(),a(s)}var G=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(d.a)(this,Object(m.a)(t).call(this))).state={gameType:"local",numPlayers:2,player1:"Charlie",player2:"Thomas",player3:"Guy",player4:"Jordan",player5:""},e}return Object(h.a)(t,e),Object(u.a)(t,[{key:"createGame",value:function(){for(var e=[],t=0;t<this.state.numPlayers;t++)e.push(this.state["player"+(t+1)]);if("local"===this.state.gameType){var a=b(e);window.location.href+="?id="+a.id,this.gameWasCreated.bind(this)(a)}}},{key:"gameWasCreated",value:function(e){console.log("game was created",e)}},{key:"onRadioClick",value:function(e){this.setState({gameType:e})}},{key:"nameChange",value:function(e){this.setState(Object(y.a)({},"player"+(+e.target.attributes.player.value+1),e.target.value))}},{key:"render",value:function(){var e=this,t=Array(this.state.numPlayers).fill("player").map(function(e,t){return e+(t+1)}).map(function(t){return e.state[t]}),a=t.every(function(e){return e.length>0}),n=Object(v.a)(new Set(t)).length!==t.length,r="local"===this.state.gameType?"success":"secondary",s="online"===this.state.gameType?"success":"secondary",l=Array(4).fill("").map(function(t,a){return i.a.createElement(p.a,{key:a,active:e.state.numPlayers===2+a,color:e.state.numPlayers===2+a?"success":"secondary",onClick:function(){return e.setState({numPlayers:a+2})}},2+a)}),o=Array(this.state.numPlayers).fill("").map(function(a,n){return i.a.createElement(p.i,{key:n},i.a.createElement(p.c,{xs:{size:10,offset:1}},i.a.createElement(p.f,null,e.state["player"+(n+1)].length>0&&t.filter(function(t){return t===e.state["player"+(n+1)]}).length>1&&i.a.createElement(p.g,{color:"danger"},"Duplicate Name"),i.a.createElement(p.e,{player:n,placeholder:"Player "+(n+1)+"'s name",onChange:e.nameChange.bind(e),value:e.state["player"+(n+1)]}))))});return i.a.createElement("div",null,i.a.createElement("h1",null,"Create a Hanabi Game!"),i.a.createElement(p.b,null,i.a.createElement(p.a,{color:r,onClick:function(){return e.onRadioClick("local")},active:"local"===this.state.gameType},"Local Game"),i.a.createElement(p.a,{color:s,onClick:function(){return e.onRadioClick("online")},active:"online"===this.state.gameType},"Online Game")),i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement(p.b,null,i.a.createElement(p.a,{color:""},"How Many Players?"),l),i.a.createElement("br",null),i.a.createElement("br",null),o,i.a.createElement("br",null),!n&&a&&i.a.createElement(p.a,{onClick:this.createGame.bind(this),color:"success"},"Start Game"),!a&&i.a.createElement(p.a,{color:"danger"},"Give Each Player a Name"))}}]),t}(r.Component),M=a(22),N=new(a(23).Dispatcher);N.cardSelected=function(e,t,a){this.dispatch({source:"CARD_SELECTED",cardId:e.id,props:e,playerName:t,isYou:a})},N.moveMade=function(){this.dispatch({source:"MOVE_MADE"})};var D=N,P=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(d.a)(this,Object(m.a)(t).call(this))).state={selected:!1},e}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.register=D.register(this.eventReceived.bind(this))}},{key:"componentWillUnmount",value:function(){D.unregister(this.register)}},{key:"eventReceived",value:function(e){switch(e.source){case"CARD_SELECTED":this.setState({selected:e.cardId===this.props.id&&!this.state.selected})}}},{key:"render",value:function(){var e=this,t=(this.props.colors||[]).map(function(e,t){return i.a.createElement("span",{key:t,className:"advise color "+e})}),a=(this.props.numbers||[]).map(function(e,t){return i.a.createElement("span",{key:t,className:"advise number "+e},e)});return i.a.createElement("div",{onClick:function(){return e.props.clickHandler(e.props.id)},className:this.props.color+" gamecard "+(this.props.played?" played ":"")+(this.state.selected?" selected ":"")},i.a.createElement("div",null,i.a.createElement("span",{className:"playedNumber"},void 0===this.props.number?"?":this.props.number),this.props.discard||this.props.played?"":i.a.createElement("div",null,i.a.createElement("div",null,t),i.a.createElement("div",null,a))))}}]),t}(r.Component),T=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"play",value:function(){C(this.props.id,this.gotMoveResult.bind(this))}},{key:"discard",value:function(){j(this.props.id,this.gotMoveResult.bind(this))}},{key:"color",value:function(){S(this.props.id,this.props.color,this.gotMoveResult.bind(this))}},{key:"number",value:function(){S(this.props.id,this.props.number,this.gotMoveResult.bind(this))}},{key:"gotMoveResult",value:function(){D.moveMade()}},{key:"render",value:function(){return i.a.createElement(p.d,null,i.a.createElement(p.i,null,i.a.createElement(p.c,null,this.props.isYou?"your":this.props.playerName+"'s"," card")),i.a.createElement(p.i,null,i.a.createElement(p.c,null,this.props.isYou?i.a.createElement("div",null,i.a.createElement(p.a,{onClick:this.play.bind(this),color:"primary"},"Play"),this.props.advise<8?i.a.createElement(p.a,{onClick:this.discard.bind(this),color:"warning"},"Discard"):i.a.createElement("div",null,"Cannot discard with full advise")):i.a.createElement("div",null,this.props.advise>0?i.a.createElement("div",null,i.a.createElement(p.a,{onClick:this.color.bind(this),color:"info"},"Advise All ",this.props.color,"s"),i.a.createElement(p.a,{onClick:this.number.bind(this),color:"primary"},"Advise All ",this.props.number,"s")):i.a.createElement("span",null,"No advise tokens")))))}}]),t}(r.Component),L=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"cardClicked",value:function(e){D.cardSelected(this.props.hand.filter(function(t){return t.id===e})[0],this.props.name,this.props.you)}},{key:"render",value:function(){var e=this,t="";if(this.props.lastMove)switch(this.props.lastMove[0]){case"Play":t=this.props.lastMove[1]?i.a.createElement("div",{className:"lastMove"},"Played a ",i.a.createElement(P,Object.assign({discard:!0},this.props.lastMove[2]))):i.a.createElement("div",{className:"lastMove"},"Tried to play a ",i.a.createElement(P,Object.assign({discard:!0},this.props.lastMove[2]))," but it didn't play");break;case"Advise":t=i.a.createElement("div",null,"Told ",this.props.lastMove[1]," about their ",this.props.lastMove[2],"'s");break;case"Discard":t=i.a.createElement("div",{className:"lastMove"},"Discarded a ",i.a.createElement(P,Object.assign({discard:!0},this.props.lastMove[1])))}var a=this.props.hand.map(function(t,a){return i.a.createElement(P,Object.assign({clickHandler:e.cardClicked.bind(e),key:a},t))});return i.a.createElement(p.d,null,i.a.createElement(p.i,null,i.a.createElement(p.c,{xs:12},this.props.name,this.props.you&&" (you)",t)),i.a.createElement(p.i,null,i.a.createElement(p.c,{xs:12},a)))}}]),t}(r.Component),A=a(16),I=a.n(A),R=a(24),x=a(25),H=function(e){function t(e){var a;Object(c.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).dev=!1,a.noBackend={load:function(){alert("you tried to play a game with no backend (probably online)")}};var r=e.isLocal?n:a.noBackend;return a.state={backend:r,playerGameState:{},selectedCard:void 0},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.state.backend.load(this.props.id,this.gameLoaded.bind(this)),D.register(this.eventReceived.bind(this))}},{key:"eventReceived",value:function(e){switch(e.source){case"CARD_SELECTED":this.setState({selectedCard:this.state.selectedCard===e.cardId?void 0:e.cardId,selectedCardProps:Object(M.a)({},e.props,{playerName:e.playerName,isYou:e.isYou})});break;case"MOVE_MADE":this.setState({countDown:this.dev?3:5}),this.state.backend.getCurrPlayerState(this.gotCurrPlayerState.bind(this))}}},{key:"wipeGame",value:function(){window.confirm("Permanently delete this game")&&(E(),window.location.href=window.location.href.split("?")[0])}},{key:"gameLoaded",value:function(e){this.state.backend.getCurrPlayerState(this.gotCurrPlayerState.bind(this))}},{key:"countDown",value:function(){var e=this,t=this.state.countDown-1;this.setState({countDown:t}),t>0&&setTimeout(function(){return e.countDown()},this.dev?200:1e3)}},{key:"gotCurrPlayerState",value:function(e){var t=this;console.log("playerGameState",e),this.props.isLocal&&(this.setState({countDown:this.dev?3:5}),setTimeout(function(){return t.countDown()},this.dev?200:1e3)),this.setState({playerGameState:e,lastMove:e.lastMove,playerName:e.players.filter(function(e){return e.you})[0].name,selectedCard:void 0})}},{key:"render",value:function(){var e=this,t=Array(this.state.playerGameState.bombs||0).fill("").map(function(e,t){return i.a.createElement(I.a,{key:t,icon:R.a,size:"lg"})}),a=Array(this.state.playerGameState.advice||0).fill("").map(function(e,t){return i.a.createElement(I.a,{className:"advice",key:t,icon:x.a,size:"lg"})}),n=Object.keys(this.state.playerGameState.played||{}).map(function(t,a){return i.a.createElement(P,{clickHandler:function(){},key:a,color:t,number:e.state.playerGameState.played[t],played:!0})}),r=(this.state.playerGameState.players||[]).map(function(e,t){return i.a.createElement(L,Object.assign({key:t},e))}),s={red:[],blue:[],green:[],white:[],yellow:[]},l=!0,o=!1,c=void 0;try{for(var u,d=(this.state.playerGameState.discards||[])[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var m=u.value;s[m.color].push(m)}}catch(y){o=!0,c=y}finally{try{l||null==d.return||d.return()}finally{if(o)throw c}}var h=Object.keys(s).map(function(e,t){return i.a.createElement("div",{key:t},s[e].sort(function(e,t){return e.number-t.number}).map(function(e,t){return i.a.createElement(P,Object.assign({clickHandler:function(){},key:t},e,{discard:!0}))}))}),v="";if(this.state.lastMove)switch(this.state.lastMove[0]){case"Play":v=this.state.lastMove[1]?i.a.createElement("div",{className:"lastMove"},this.state.lastMove.slice(-1)[0]," Played a ",i.a.createElement(P,Object.assign({discard:!0},this.state.lastMove[2]))):i.a.createElement("div",{className:"lastMove"},this.state.lastMove.slice(-1)[0]," Tried to play a",i.a.createElement(P,Object.assign({discard:!0},this.state.lastMove[2])),"but it didn't play");break;case"Advise":v=i.a.createElement("div",null,this.state.lastMove.slice(-1)[0],"Told ",this.state.lastMove[1]," about their ",this.state.lastMove[2],"'s");break;case"Discard":v=i.a.createElement("div",{className:"lastMove"},this.state.lastMove.slice(-1)[0]," Discarded a",i.a.createElement(P,Object.assign({discard:!0},this.state.lastMove[1])))}return i.a.createElement("div",null,this.state.countDown>0?i.a.createElement("div",null,i.a.createElement("h1",null,"Preparing for ",this.state.playerName,"'s Turn "),i.a.createElement("h1",null,this.state.countDown),v):i.a.createElement("div",null,i.a.createElement("h3",null,this.state.playerName,"'s Turn"),r,i.a.createElement("br",null),this.state.selectedCard&&i.a.createElement(T,Object.assign({id:this.state.selectedCard},this.state.selectedCardProps,{advise:this.state.playerGameState.advice}))),i.a.createElement("hr",null),i.a.createElement("div",{className:"discards"},i.a.createElement("h3",null,"Discards"),h),i.a.createElement("h3",null,"Played Cards"),n,i.a.createElement("br",null),i.a.createElement("div",{className:"iconHolder"},a),i.a.createElement("div",{className:"iconHolder"},t),this.state.playerGameState.id&&i.a.createElement(p.d,null,i.a.createElement(p.i,{id:"deckLeft"},i.a.createElement(p.c,{xs:{size:10,offset:1}},i.a.createElement("div",null,this.state.playerGameState.cardsInDeck," cards left"),i.a.createElement(p.h,{multi:!0},i.a.createElement(p.h,{bar:!0,value:2*(50-this.state.playerGameState.cardsInDeck),animated:!0,color:"warning"}),i.a.createElement(p.h,{bar:!0,value:2*this.state.playerGameState.cardsInDeck}))))),this.props.isLocal&&i.a.createElement("div",null,i.a.createElement(p.a,{onClick:this.wipeGame.bind(this),color:"danger"},"Wipe Game")))}}]),t}(r.Component),W=(a(50),function(e){function t(){var e;Object(c.a)(this,t),e=Object(d.a)(this,Object(m.a)(t).call(this));var a=window.location.href.split("?"),n=void 0;if(2===a.length){var r=a[1].split("&"),i=!0,s=!1,l=void 0;try{for(var u,h=r[Symbol.iterator]();!(i=(u=h.next()).done);i=!0){var p=u.value.split("="),v=Object(o.a)(p,2),y=v[0],f=v[1];"id"===y.toLowerCase()&&(n=f)}}catch(E){s=!0,l=E}finally{try{i||null==h.return||h.return()}finally{if(s)throw l}}}var g=Object.getOwnPropertyNames(localStorage),b=g.indexOf("game"+n)>-1;return e.state={gameId:n,isLocalGame:b,currentLocalGames:g},e}return Object(h.a)(t,e),Object(u.a)(t,[{key:"localGameChosen",value:function(e){console.log("gid",e),window.location.href=window.location.href.split("?")[0]+"?id="+e.slice(4)}},{key:"render",value:function(){var e=this,t=this.state.currentLocalGames.filter(function(t){return t!=="game"+e.state.gameId}).map(function(e){return[e,new Date(+e.split("-")[0].slice(4))]}).map(function(t,a){return i.a.createElement(p.a,{key:a,color:"",onClick:function(){return e.localGameChosen.bind(e)(t[0])}},"Game started: "+t[1].toLocaleDateString()+" "+t[1].toLocaleTimeString())});return i.a.createElement("div",{className:"App"},this.state.gameId?i.a.createElement(H,{id:this.state.gameId,isLocal:this.state.isLocalGame}):i.a.createElement(G,null),i.a.createElement("br",null),t)}}]),t}(r.Component)),J=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Y(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}a(51);l.a.render(i.a.createElement(W,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/hanabi",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/hanabi","/service-worker.js");J?function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Y(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e):Y(e)})}}()}},[[28,1,2]]]);
//# sourceMappingURL=main.57d851a5.chunk.js.map